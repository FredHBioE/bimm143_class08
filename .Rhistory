knitr::opts_chunk$set(echo = TRUE)
tmp <- c(rnorm(30, -3), rnorm(30, 3))
x <- cbind(x = tmp, y = rev(tmp))
plot(x)
?rev
?kmeans
kmeans(x, centers = 2, nstart = 20)
cluster1 <- kmeans(x, centers = 2, nstart = 20)
cluster1.cluster
cluster1 <- kmeans(x, centers = 2, nstart = 20)
cluster1$centers
cluster1$cluster
cluster1$size
palette(c("blue", "green", "red"))
plot(x, col = cluster1$cluster)
palette(c("red", "black", "blue"))
plot(x, col = cluster1$cluster)
palette(c("red", "black", "blue"))
plot(x, col = cluster1$cluster, pch = 20)
palette(c("red", "black"))
plot(x, col = cluster1$cluster, pch = 20)
points(cluster1$centers, pch = 20, col = "blue")
palette(c("red", "black"))
plot(x, col = cluster1$cluster, pch = 20)
points(cluster1$centers, pch = 18, col = "blue")
palette(c("red", "black"))
plot(x, col = cluster1$cluster, pch = 20)
points(cluster1$centers, pch = 18, col = "blue", cex = 6)
palette(c("red", "black"))
plot(x, col = cluster1$cluster, pch = 20)
points(cluster1$centers, pch = 18, col = "blue", cex = 4)
palette(c("red", "black"))
plot(x, col = cluster1$cluster, pch = 20)
points(cluster1$centers, pch = 18, col = "blue", cex = 2)
# Distance matrix calculation
d <- dist(x)
# Clustering
hc <- hclust(d)
plot(hc)
# Distance matrix calculation
d <- dist(x)
# Clustering
hc <- hclust(d)
plot(hc)
abline(h = 6, col = "red")
# Distance matrix calculation
d <- dist(x)
# Clustering
hc <- hclust(d)
plot(hc)
abline(h = 8, col = "red")
# Distance matrix calculation
d <- dist(x)
# Clustering
hc <- hclust(d)
plot(hc)
abline(h = 8, col = "red")
cutree(hc, h = 8)
# Distance matrix calculation
d <- dist(x)
# Clustering
hc <- hclust(d)
plot(hc)
abline(h = 8, col = "red")
cutree(hc, k = 2)
# Distance matrix calculation
d <- dist(x)
# Clustering
hc <- hclust(d)
plot(hc)
abline(h = 6, col = "red")
cutree(hc, k = 2)
plot(hclust(dist(x)))
plot(cuttree(hclust(dist(x)), k = 2))
plot(cutree(hclust(dist(x)), k = 2))
cutree(hclust(dist(x)), k = 2)
cutree(hclust(dist(x)), k = 3)
cluster1$cluster <- cutree(hclust(dist(x)), k = 3)
plot(x, col = cluster1$cluster, pch = 20)
palette(c("red", "black", "green"))
cluster1$cluster <- cutree(hclust(dist(x)), k = 3)
plot(x, col = cluster1$cluster, pch = 20)
palette(c("red", "black", "green", "yellow"))
cluster1$cluster <- cutree(hclust(dist(x)), k = 4)
plot(x, col = cluster1$cluster, pch = 20)
mydata <- read.csv("expression.csv")
View(mydata)
mydata <- read.csv("expression.csv")
colnames(mydata)
mydata <- read.csv("expression.csv")
colnames(mydata)
pca <- prcomp(t(mydata), scale = TRUE)
mydata <- read.csv("expression.csv")
colnames(mydata)
head(t(mydata))
#pca <- prcomp(, scale = TRUE)
mydata <- read.csv("expression.csv")
colnames(mydata)
#head(t(mydata))
pca <- prcomp(t(mydata), scale = TRUE)
mydata <- read.csv("expression.csv")
#colnames(mydata)
#head(t(mydata))
pca <- prcomp(t(mydata), scale = TRUE)
?prcomp
View(mydata)
mydata <- read.csv("expression.csv")
#colnames(mydata)
#head(t(mydata))
pca <- prcomp(t(mydata), scale = TRUE)
?prcomp
mydata <- read.csv("expression.csv")
#colnames(mydata)
#head(t(mydata))
t(mydata)
#pca <- prcomp(t(mydata), scale = TRUE)
mydata <- read.csv("expression.csv")
#colnames(mydata)
#head(t(mydata))
transposedData <- t(mydata)
pca <- prcomp(transposedData, scale = TRUE)
View(transposedData)
mydata <- read.csv("expression.csv", row.names = 1)
#colnames(mydata)
#head(t(mydata))
transposedData <- t(mydata)
pca <- prcomp(transposedData, scale = TRUE)
View(pca)
mydata <- read.csv("expression.csv", row.names = 1)
#colnames(mydata)
#head(t(mydata))
transposedData <- t(mydata)
pca <- prcomp(transposedData, scale = TRUE)
colvec <- colnames(mydata)
colvec[grep("wt", colvec)] <- "red"
colvec[grep("ko", colvec)] <- "blue"
plot(pca$x[,1], pca$x[,2], col = colvec, pch = 16,
xlab = paste0("PC1 (", pca.var.per[1], "%)"),
ylab = paste0("PC2 (", pca.var.per[2], "%)"))
mydata <- read.csv("expression.csv", row.names = 1)
#colnames(mydata)
#head(t(mydata))
transposedData <- t(mydata)
pca <- prcomp(transposedData, scale = TRUE)
pca.var <- pca$sdev^2
pca.var.per <- round(pca.var/sum(pca.var)*100, 1)
colvec <- colnames(mydata)
colvec[grep("wt", colvec)] <- "red"
colvec[grep("ko", colvec)] <- "blue"
plot(pca$x[,1], pca$x[,2], col = colvec, pch = 16,
xlab = paste0("PC1 (", pca.var.per[1], "%)"),
ylab = paste0("PC2 (", pca.var.per[2], "%)"))
x <- read.csv("UK_foods.csv")
View(transposedData)
View(x)
x <- read.csv("UK_foods.csv", row.names = 1)
View(x)
x <- read.csv("UK_foods.csv", row.names = 1)
barplot(as.matrix(x), beside=T, col=rainbow(nrow(x)))
x <- read.csv("UK_foods.csv", row.names = 1)
barplot(as.matrix(x), beside=T, col=rainbow(nrow(x)), beside = FALSE)
x <- read.csv("UK_foods.csv", row.names = 1)
barplot(as.matrix(x), beside=T, col=rainbow(nrow(x)), beside = F)
x <- read.csv("UK_foods.csv", row.names = 1)
barplot(as.matrix(x), beside=T, col=rainbow(nrow(x)), beside = T)
x <- read.csv("UK_foods.csv", row.names = 1)
barplot(as.matrix(x), beside=T, col=rainbow(nrow(x)), beside = TRUE)
x <- read.csv("UK_foods.csv", row.names = 1)
barplot(as.matrix(x), beside=F, col=rainbow(nrow(x)))
x <- read.csv("UK_foods.csv", row.names = 1)
barplot(as.matrix(x), beside=F, col=rainbow(nrow(x)))
pairs(x, col=rainbow(10), pch=16)
x <- read.csv("UK_foods.csv", row.names = 1)
barplot(as.matrix(x), beside=F, col=rainbow(nrow(x)))
pairs(x, col=rainbow(10), pch=16)
pca <- prcomp(t(x))
x <- read.csv("UK_foods.csv", row.names = 1)
barplot(as.matrix(x), beside=F, col=rainbow(nrow(x)))
pairs(x, col=rainbow(10), pch=16)
pca <- prcomp(t(x))
plot(pca$x[,1], pca$x[,2], xlab="PC1", ylab="PC2", xlim=c(-270,500))
text(pca$x[,1], pca$x[,2], colnames(x))
x <- read.csv("UK_foods.csv", row.names = 1)
barplot(as.matrix(x), beside=F, col=rainbow(nrow(x)))
pairs(x, col=rainbow(10), pch=16)
pca <- prcomp(t(x))
plot(pca$x[,1], pca$x[,2], xlab="PC1", ylab="PC2", xlim=c(-270,500), col = c("blue", "red", "green", "yellow"))
text(pca$x[,1], pca$x[,2], colnames(x))
x <- read.csv("UK_foods.csv", row.names = 1)
barplot(as.matrix(x), beside=F, col=rainbow(nrow(x)))
pairs(x, col=rainbow(10), pch=16)
pca <- prcomp(t(x))
plot(pca$x[,1], pca$x[,2], xlab="PC1", ylab="PC2", xlim=c(-270,500), col = c("blue", "red", "green", "yellow"))
text(pca$x[,1], pca$x[,2], colnames(x), col = c("blue", "red", "green", "yellow"))
x <- read.csv("UK_foods.csv", row.names = 1)
barplot(as.matrix(x), beside=F, col=rainbow(nrow(x)))
pairs(x, col=rainbow(10), pch=16)
pca <- prcomp(t(x))
plot(pca$x[,1], pca$x[,2], xlab="PC1", ylab="PC2", xlim=c(-270,500), col = c("blue", "red", "green", "orange"))
text(pca$x[,1], pca$x[,2], colnames(x), col = c("blue", "red", "green", "orange"))
x <- read.csv("UK_foods.csv", row.names = 1)
barplot(as.matrix(x), beside=F, col=rainbow(nrow(x)))
pairs(x, col=rainbow(10), pch=16)
pca <- prcomp(t(x))
plot(pca$x[,1], pca$x[,2], xlab="PC1", ylab="PC2", xlim=c(-270,500), col = c("blue", "red", "green", "orange"))
text(pca$x[,1], pca$x[,2], colnames(x), col = c("blue", "red", "green", "orange"))
v <- round( pca$sdev^2/sum(pca$sdev^2) * 100 )
barplot(v, xlab = "Principal Component", ylab = "Variations")
x <- read.csv("UK_foods.csv", row.names = 1)
barplot(as.matrix(x), beside=F, col=rainbow(nrow(x)))
pairs(x, col=rainbow(10), pch=16)
pca <- prcomp(t(x))
plot(pca$x[,1], pca$x[,2], xlab="PC1", ylab="PC2", xlim=c(-270,500), col = c("blue", "red", "green", "orange"))
text(pca$x[,1], pca$x[,2], colnames(x), col = c("blue", "red", "green", "orange"))
v <- round( pca$sdev^2/sum(pca$sdev^2) * 100 )
barplot(v, xlab = "Principal Component", ylab = "Percent Variation")
biplot(pca)
summary(pca)
